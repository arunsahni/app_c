var collabmedia=angular.module("collabmedia");collabmedia.controllerProvider.register("indexCtrl",["$scope","$sce","$http","$location","$window","$upload","$stateParams","loginService","$timeout","$compile","$controller","$rootScope",function(e,a,t,o,n,s,d,r,l,c,p,u){function m(){function e(){$(window).scrollTop()>250&&0==i&&(i=1,$(".navbar").addClass("navbar-fixed-top").css({opacity:0,top:-30}).animate({opacity:1,top:0},200,function(){}),$(".navbar").addClass("navbar-fissa"),$(".navbar").removeClass("navbar-statica"),$(".navbar").addClass("navbar-inverse"),$(".navbar").removeClass("navbar-default")),$(window).scrollTop()<250&&1==i&&(i=0,$(".navbar").animate({opacity:0,top:-30},200,function(){$(".navbar").removeClass("navbar-fixed-top"),$(".navbar").removeClass("navbar-fissa"),$(".navbar").addClass("navbar-statica").animate({opacity:1,top:0},300)}),$(".navbar").addClass("navbar-default"),$(".navbar").removeClass("navbar-inverse"))}function a(){new Maplace({locations:suppliers,map_options:{set_center:[41.892916,12.48252],mapTypeControl:!1,streetViewControl:!0,panControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM,style:google.maps.ZoomControlStyle.DEFAULT},scrollwheel:!1,zoom:5},generate_controls:!1,styles:{"Monte Ré":[{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{},{lightness:0}]},{stylers:[{saturation:-100},{hue:"#735768"}]}]}}).Load()}var t,i=0,o=90,n=$("#section_nav").find("a"),s=n.map(function(){var e=$($(this).attr("href"));return e.length?e:void 0});n.click(function(e){var a=$(this).attr("href"),t="#"===a?0:$(a).offset().top-o+1;$("html, body").stop().animate({scrollTop:t},1e3,"easeInOutExpo"),e.preventDefault()}),$(window).scroll(function(){if($(window).width()>=768&&e(),$(this).scrollTop()>500&&$(this).width()>1024&&$("#section_nav").length>0){$("#section_nav a").fadeIn();var a=$(this).scrollTop()+o,i=s.map(function(){return $(this).offset().top<a?this:void 0});i=i[i.length-1];var d=i&&i.length?i[0].id:"";t!==d&&(t=d,n.parent().removeClass("active").end().filter("[href=#"+d+"]").parent().addClass("active"))}else $("#section_nav a").fadeOut()}),$(window).resize(function(){$(window).width()>=768?($(".navbar-fissa .dropdown-toggle, .navbar-statica .dropdown-toggle").click(function(e){return e.preventDefault(),!1}),$(".navbar").removeClass("navbar-mobile"),$(".navbar").addClass("navbar-statica")):($(".navbar").addClass("navbar-fixed-top"),$(".navbar").addClass("navbar-mobile"),$(".navbar").removeClass("navbar-statica"),$(".navbar").removeClass("navbar-fissa"),$(".navbar").addClass("navbar-inverse"),$(".navbar").removeClass("navbar-default")),$("#section_nav").length>0&&$("#section_nav").css({"margin-top":-($("#section_nav").height()/2+8)}),$(window).trigger("scroll")}),$(window).trigger("resize"),$(document).ready(function(){function e(){var e=!1,a=$("#contact-form"),t=$("#contact-form #nome"),i=$("#contact-form #cognome"),o=$("#contact-form #telefono"),n=$("#contact-form #email"),s=$("#contact-form #messaggio");return""==t.val()?(t.addClass("required animated shake"),e=!0):t.removeClass("required animated shake"),""==i.val()?(i.addClass("required animated shake"),e=!0):i.removeClass("required animated shake"),""==o.val()?(o.addClass("required animated shake"),e=!0):o.removeClass("required animated shake"),-1==n.val().indexOf("@")||-1==n.val().indexOf(".")?(n.addClass("required animated shake"),e=!0):n.removeClass("required animated shake"),"MESSAGGIO"==s.val()||"MESSAGE"==s.val()?(s.addClass("required animated shake"),e=!0):s.removeClass("required animated shake"),1==e?!1:($(this).find(".btn").attr("disabled","disabled"),void $.ajax({type:"post",url:"/form-contatti.php",data:a.serialize(),success:function(e){a.css("overflow","hidden").animate({height:0},1e3,"easeInOutExpo",function(){a.html('<h5 class="text-center">'+e+"</h5>"),a.animate({height:200},1e3,"easeInOutExpo")})}}))}function t(){var e=!1,a=$("#newsletter-form"),t=$("#newsletter-form #email"),i=$("#newsletter-form .input-wrapper"),o=$("#newsletter-form #result");return-1==t.val().indexOf("@")||-1==t.val().indexOf(".")?(t.addClass("required animated shake"),e=!0):t.removeClass("required animated shake"),1==e?!1:void i.animate({height:0},1e3,"easeInOutExpo",function(){$.ajax({type:"post",url:"/form-newsletter.php",data:a.serialize(),success:function(e){(-1!=e.indexOf("GOT")||-1!=e.indexOf("FATTO"))&&(t.css("display","none"),o.html(e),i.animate({height:70},1e3,"easeInOutExpo",function(){})),-1!=e.indexOf("Invalid")&&(t.css("display","none"),"it"==$("#newsletter-form #lingua").val()&&(e=e.replace("Invalid Email Address:","Indirizzo email non valido.")),o.html(e),i.animate({height:70},1e3,"easeInOutExpo",function(){i.delay(1e3).animate({height:0},1e3,"easeInOutExpo",function(){o.html(""),t.css("display","block").val(""),i.animate({height:70},1e3,"easeInOutExpo",function(){})})})),-1!=e.indexOf("already")&&(t.css("display","none"),"it"==$("#newsletter-form #lingua").val()&&(e=e.replace("is already subscribed to list Monte Ré Newsletter.","è già iscritto alla newsletter.<br>"),e=e.replace("Click here to update your profile","Aggiorna qui il tuo profilo")),o.html(e),o.find("a").attr("target","_blank"),i.animate({height:70},1e3,"easeInOutExpo",function(){}))}})})}function i(){var e=$("#tracking-form-in-page"),a=$(".track-result"),t=$(".track-result > .inner"),i=$(".main-content");$("body, html").animate({scrollTop:i.offset().top-90},1e3,"easeInOutExpo",function(){}),a.animate({height:0},1e3,"easeInOutExpo",function(){$(".track-result > .loader-temp").height(50),t.html(""),e.find("#a").val(""),e.find("#b").val(""),e.find("#c").val(""),e.find("#d").val(""),e.find(".btn").removeAttr("disabled"),$(".facebook").length>0&&(window.fbAsyncInit=function(){FB.init(),FB.Canvas.setAutoGrow()})})}function o(){var e=$("#tracking-form-in-page"),a=$("#tracking-form-in-page #a"),t=($("#tracking-form-in-page #b"),$("#tracking-form-in-page #c")),o=$("#tracking-form-in-page #d");if(""!=a.val()&&""!=o.val()&&""!=t.val()&&""!=o.val()){var n=$(".track-result > .loader-temp"),s=$(".track-result > .inner"),d=$(".track-result");e.find(".btn").attr("disabled","disabled"),d.animate({height:50},500,"easeInOutExpo",function(){$.ajax({type:"POST",url:"/form-tracking.php",data:e.serialize(),success:function(e){s.html(e),n.animate({height:0},500,"easeInOutExpo",function(){}),s.find(".img-responsive").load(function(){$("body, html").animate({scrollTop:s.offset().top-150},1e3,"easeInOutExpo",function(){}),d.animate({height:s.height()+200},1e3,"easeInOutExpo",function(){$(".facebook").length>0&&(window.fbAsyncInit=function(){FB.init(),FB.Canvas.setAutoGrow()}),$(".reset-button").click(function(e){return i(),!1})})})}})})}}if($(".filtri a").click(function(){$(".filtri a.current").removeClass("current"),$(this).addClass("current");var e=$(this).data("filtro").substr(7);return"tutti"==e?$(".grid-item").animate({opacity:1},300):$(".grid-item").each(function(){$(this).hasClass(e)?$(this).animate({opacity:1},300):$(this).animate({opacity:.1},300)}),!1}),$("#section_nav").length>0&&$("#section_nav a").tooltip(),$("#faq-group .collapse").each(function(e,a){var a=$(a),t=a.parent().find("h3");a.on("show.bs.collapse",function(){$("html, body").animate({scrollTop:t.offset().top-90-40},1e3,"easeInOutExpo",function(){}),t.addClass("aperto")}),a.on("hidden.bs.collapse",function(){t.removeClass("aperto")})}),$(".dot-irecommendthis").click(function(e){var a=$(this);if(a.hasClass("active"))return!1;var t=$(this).attr("id"),i=a.find(".dot-irecommendthis-suffix").text();$.post("/wp-admin/admin-ajax.php",{action:"dot-irecommendthis",recommend_id:t,suffix:i},function(e){a.html(e).addClass("active").attr("title","")}),e.preventDefault()}),$("#gmap").length>0&&a(),$("textarea").autosize(),$("textarea").focus(function(){("MESSAGGIO"==$(this).val()||"MESSAGE"==$(this).val())&&$(this).val("").css("color","#555")}),$("textarea").blur(function(){""==$(this).val()&&$(this).val("MESSAGGIO").css("color","#999")}),$(window).width()>1200&&($(".parallax").each(function(e,a){var t=$(a);t.scrollAnimate({startScroll:t.offset().top-$(window).height(),endScroll:t.offset().top+t.height(),cssProperty:"background-position-y",before:0,after:-100})}),$(".img-block").each(function(e,a){var t=$(a);t.scrollAnimate({startScroll:t.offset().top-$(window).height(),endScroll:t.offset().top+t.height(),cssProperty:"background-position-y",before:300,after:-300})})),$(".scroll-top").click(function(e){$("body, html").animate({scrollTop:0},1e3,"easeInOutExpo"),e.preventDefault()}),$.fn.waypoint.defaults={context:window,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},$(window).width()>1024&&($.fn.waypoint.defaults={context:window,continuous:!0,enabled:!0,horizontal:!1,offset:"80%",triggerOnce:!1},$(".totop-wrapper").waypoint(function(e){"down"==e?$("#section_nav").fadeOut():$("#section_nav").fadeIn()}),$(".tofade,.toflip,.tofadel,.tofader").css("opacity",1),$(".tofade").waypoint(function(e){"down"==e?$(this).removeClass("animated fadeOutDown").addClass("animated fadeInUp"):$(this).removeClass("animated fadeInUp").addClass("animated fadeOutDown")}),$(".toflip").waypoint(function(e){"down"==e?$(this).removeClass("animated fadeOutDown").addClass("animated flipInY"):$(this).removeClass("animated flipInY").addClass("animated fadeOutDown")}),$(".tofadel").waypoint(function(e){"down"==e?$(this).removeClass("animated fadeOutLeft").addClass("animated fadeInLeft"):$(this).removeClass("animated fadeInLeft").addClass("animated fadeOutLeft")}),$(".tofader").waypoint(function(e){"down"==e?$(this).removeClass("animated fadeOutRight").addClass("animated fadeInRight"):$(this).removeClass("animated fadeInRight").addClass("animated fadeOutRight")})),$("#contact-form").submit(function(a){e(),a.preventDefault()}),$("#newsletter-form").submit(function(e){t(),e.preventDefault()}),$("#tracking-form-in-page").submit(function(e){o(),e.preventDefault()}),$("#tracking-form").submit(function(){$("#tracking-form .btn").val("").addClass("loader-temp-mini")}),""!=$("#tracking-form-in-page").find("#a").val()&&""!=$("#tracking-form-in-page").find("#b").val()&&""!=$("#tracking-form-in-page").find("#c").val()&&""!=$("#tracking-form-in-page").find("#d").val()&&$(".track-result > .inner").length>0){var n=$(".track-result > .inner");$("body, html").animate({scrollTop:n.offset().top-200},1500,"easeInOutExpo",function(){$("#tracking-form-in-page").trigger("submit")})}$(window).trigger("resize")})}e.search1={},e.__isMontagePrivate=!1;var f={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return f.Android()||f.BlackBerry()||f.iOS()||f.Opera()||f.Windows()}};e.mobileDevice=f.any(),$(window).width()<=650&&($(".avatar-widget").css({display:"none"}),$(window).width()<=650&&$("#media-tray-elements li").length>0&&$(".avatar-widget").css({display:"block"})),$("#tb-1").click(function(){$("#cur_txt").focus()}),$("#tb-2").click(function(){$("#invt_txt").focus()}),$("#searchfld").click(function(){e.search1.tata2=null,e.byDesc=!1,e.byTheme=!0}),$("#searchfld2").click(function(){e.search1.tata1=null,e.byDesc=!0,e.byTheme=!1}),e.search1.tata="",e.search1.gt="",e.membrNm={},e.acceptedOn=null,e.currentTheme="No Theme",e.setName=function(){var e=0;$(".col-xs-4").find("a").each(function(){$(this).attr("name",e),e+=1})},setTimeout(function(){e.setName()},6e3),e.current_boardId=d.id,e.getBoardData=function(){t.post("/boards",{id:d.id}).then(function(a){200==a.data.code&&(e.boarddata=a.data.response,u.boarddata2=a.data.response)})},e.commentIndex=function(e){console.log("$scope.commentIndex = func = "+e)};var g=function(){t.post("/boards",{id:d.id}).then(function(a){200==a.data.code&&(u.boarddata2=a.data.response,e.boarddata=a.data.response,e.boardMembers=null!=e.boarddata[0].Invitees&&e.boarddata[0].Invitees.length>0?!0:!1,e.boardComments=null!=e.boarddata[0].Comments&&e.boarddata[0].Comments.length>0?!0:!1,e.gt=a.data.response[0].Themes,e.title=a.data.response[0].Title,e.rename.title=a.data.response[0].Title,l(function(){e.userInfo._id==e.boarddata[0].OwnerID._id&&(e.showsetting=1),"FriendsSolo"!=e.boarddata[0].PrivacySetting[0].BoardType||e.showsetting||(e.isFriendSolo=1),t.get("/projects").then(function(a){if(200==a.data.code){e.projects=a.data.response;for(i in e.projects)e.projectsa.push({label:e.projects[i].ProjectTitle,value:e.projects[i]._id})}});for(x in e.boarddata[0].Themes)0==e.boarddata[0].Themes[x].isApproved&&e.groupta.push(e.boarddata[0].Themes[x].SuggestedBy==e.userInfo._id||e.showsetting?{id:e.boarddata[0].Themes[x].ThemeID,title:e.boarddata[0].Themes[x].ThemeTitle,canDeleted:"1",canAdded:"0"}:{id:e.boarddata[0].Themes[x].ThemeID,title:e.boarddata[0].Themes[x].ThemeTitle,canDeleted:"0",canAdded:"0"});for(x in e.boarddata[0].Themes)for(z in e.groupta)e.boarddata[0].Themes[x].ThemeID==e.groupta[z].id&&e.boarddata[0].Themes[x].ThemeTitle!=e.groupta[z].title&&(e.groupta[z].title=e.boarddata[0].Themes[x].ThemeTitle+" ("+e.groupta[z].title+")"),e.boarddata[0].Themes[x].ThemeID==e.groupta[z].id&&0!=e.boarddata[0].Themes[x].isApproved&&(e.boarddata[0].Themes[x].SuggestedBy==e.userInfo._id||e.showsetting?(e.groupta[z].canDeleted="1",e.groupta[z].canAdded="0"):(e.groupta[z].canDeleted="0",e.groupta[z].canAdded="0"));for(z in e.groupta)"undefined"==typeof e.groupta[z].canDeleted&&"undefined"==typeof e.groupta[z].canAdded&&(e.groupta[z].canDeleted="0",e.groupta[z].canAdded="1");console.log("Final Group Tags",e.groupta),"undefined"!=typeof e.boarddata[0].HeaderImage&&""!=e.boarddata[0].HeaderImage&&(e.headerstyle="background:url(../assets/board/headerImg/"+e.boarddata[0].HeaderImage+");"),"undefined"!=typeof e.boarddata[0].BackgroundMusic&&""!=e.boarddata[0].BackgroundMusic&&$("#audio").attr("src","../assets/board/backgroundAudio/"+e.boarddata[0].BackgroundMusic),$(document).ready(function(){$(".customScrollbar").mCustomScrollbar(),startupall(),$("#filterbar").hover(function(){$(".searchinglist").addClass("highlight")},function(){$(".searchinglist").removeClass("highlight")}),$("#tips-btn").click(function(){$("#questionMenu").fadeOut("slow",function(){$("#tips, .ui-widget-overlay").fadeIn("slow")})}),$("#closetips").click(function(){$("#tips, .ui-widget-overlay").fadeOut("slow",function(){$("#questionMenu").fadeIn("slow")})}),$(".sidemenu").click(function(){return $("nav").slideToggle(500),$(this).toggleClass("active"),!1}),setTimeout(function(){jQuery(".text_wrap_index").each(function(){"IFRAME"!=$(this).children().first().prop("tagName")}),$(".text_wrap p img").parent().addClass("innerimg-wrap")},1500),e.changePT()})},2500))})};g(),e.update__PTObject=function(){e.groupt=[],e.groupta=[];for(i in e.gts)1==e.gts[i].status&&e.groupta.push({id:e.gts[i]._id,title:e.gts[i].GroupTagTitle}),e.groupt.push({value:e.gts[i]._id,label:e.gts[i].GroupTagTitle});for(x in e.boarddata[0].Themes)0==e.boarddata[0].Themes[x].isApproved&&e.groupta.push(e.boarddata[0].Themes[x].SuggestedBy==e.userInfo._id||e.showsetting?{id:e.boarddata[0].Themes[x].ThemeID,title:e.boarddata[0].Themes[x].ThemeTitle,canDeleted:"1",canAdded:"0"}:{id:e.boarddata[0].Themes[x].ThemeID,title:e.boarddata[0].Themes[x].ThemeTitle,canDeleted:"0",canAdded:"0"});for(x in e.boarddata[0].Themes)for(z in e.groupta)e.boarddata[0].Themes[x].ThemeID==e.groupta[z].id&&e.boarddata[0].Themes[x].ThemeTitle!=e.groupta[z].title&&(e.groupta[z].title=e.boarddata[0].Themes[x].ThemeTitle+" ("+e.groupta[z].title+")"),e.boarddata[0].Themes[x].ThemeID==e.groupta[z].id&&0!=e.boarddata[0].Themes[x].isApproved&&(e.boarddata[0].Themes[x].SuggestedBy==e.userInfo._id||e.showsetting?(e.groupta[z].canDeleted="1",e.groupta[z].canAdded="0"):(e.groupta[z].canDeleted="0",e.groupta[z].canAdded="0"));for(z in e.groupta)"undefined"==typeof e.groupta[z].canDeleted&&"undefined"==typeof e.groupta[z].canAdded&&(e.groupta[z].canDeleted="0",e.groupta[z].canAdded="1");console.log("Final Group Tags",e.groupta)},e.update__MembersObject=function(){t.post("/boards",{id:d.id}).then(function(a){200==a.data.code&&(e.boarddata[0].Invitees=a.data.response[0].Invitees,e.boardMembers=null!=e.boarddata[0].Invitees&&e.boarddata[0].Invitees.length>0?!0:!1)})},e.runVendorScripts=function(){mediaSite.tooltip(),mediaSite.initMasonry(),mediaSite.slideTitleHeader(),mediaSite.initModalPopup(),mediaSite.mediaDropDownMenu(),mediaSite.actionBarDropDown(),mediaSite.recordButton(),mediaSite.uploadButton(),mediaSite.tagButton(),mediaSite.initSmallHeader(),mediaSite.headerTitleDropDown(),mediaSite.headerQuestionDropDown(),mediaSite.fixDiscussPage(),mediaSite.showMediaContent(),mediaSite.filterMenuSidebar.fixHeight(),mediaSite.openFullHeader(),mediaSite.headerThemeDropdown()},e.runVendorScripts2=function(){mediaSite.slideTitleHeader(),mediaSite.initModalPopup(),mediaSite.headerTitleDropDown(),mediaSite.headerThemeDropdown(),mediaSite.closeAllDropdowns.init()},e.notes={},e.searcha=null,e.clear=function(){0==e.searcha.length&&delete e.searcha},e.openWindow=function(e){alert(e),window.open(e,"_blank")},e.fsgs=[],t.get("/fsg/view").then(function(a){200==a.data.code&&(e.fsgs=a.data.response,console.log("fsg"),console.log(e.fsgs),console.log(e.userInfo))}),p("filterCtrl",{$scope:e}),p("mediaTrayCtrl",{$scope:e}),e.id=d.id,e.boarddataAll={},e.boarddata={},e.showsetting=0,e.userInfo={},e.media={},e.changemmt=function(a){e.media.mmt=a},e.changemmtlink=function(a){e.link.mmt=a},t.get("/metaMetaTags/view").then(function(a){if(200==a.data.code){for(i in a.data.response)"54c98aab4fde7f30079fdd5a"==a.data.response[i]._id&&a.data.response.splice(i,1);e.mmt=a.data.response}else e.mmt={}}),e.gts={},e.groupt=[],e.groupta=[],e.tagss=[],e.tagta=[],t.get("/groupTags/without_descriptors").then(function(a){if(200==a.data.code){e.gts=a.data.response;for(i in e.gts)if(3!=e.gts[i].status){e.groupta.push({id:e.gts[i]._id,title:e.gts[i].GroupTagTitle}),e.groupt.push({value:e.gts[i]._id,label:e.gts[i].GroupTagTitle});for(j in e.gts[i].Tags)1==e.gts[i].Tags[j].status&&e.tagta.push({value:e.gts[i]._id,label:e.gts[i].Tags[j].TagTitle,description:e.gts[i].GroupTagTitle})}}}),e.descriptors={},t.get("/media/descriptor").then(function(a){200==a.data.code&&(e.descriptors=a.data.response,$("#searchfld2").autocomplete({source:e.descriptors,select:function(a,t){return e.descSearch=t.item.label,e.search1.tata2=t.item.label,$("a.searchBar").parent().addClass("active"),$("li.searchBar").removeClass("hidden"),e.filterSub__descriptor(e.descSearch),!1},focus:function(a,t){return e.descSearch=t.item.label,e.search1.tata2=t.item.label,$("a.searchBar").parent().addClass("active"),$("li.searchBar").removeClass("hidden"),!1}}))}),e.project={},e.projects={},e.projectsa=[],e.isFriendSolo=0,e.link={},e.uploadedLink={},e.aclicked=function(e){console.log(e.target)};var h=[];e.selectedgt="";var v=0,b=[],w=-1;e.changePT=function(a){l(function(){$("#slideTitleHeader li").each(function(){"hidden"!=$(this).css("visibility")&&(e.selectedgt=$(this).attr("id"),e.selectedgtsa=$(this).find("span").html(),"next"==a?(e.getNextPageTheme(),e.isNextTheme=!0):"previous"==a&&(e.getPrevPageTheme(),e.isPrevTheme=!0),"none"==$("#search_elements").css("display")?($(".loader_overlay").show(),$(".loader_img_overlay").show(),t.post("/boards",{id:d.id}).then(function(a){if(200==a.data.code){e.boarddata=a.data.response,console.log("board data = ",e.boarddata),newdata=[];for(d in e.boarddata[0].Medias)e.boarddata[0].Medias[d].PostStatement=e.boarddata[0].Medias[d].PostStatement?$("<div>").html(e.boarddata[0].Medias[d].PostStatement).text():"No Statement",e.selectedgt==e.boarddata[0].Medias[d].ThemeID&&newdata.push(e.boarddata[0].Medias[d]);e.boarddata[0].Medias=[],e.boarddata[0].Medias=newdata;for(var t=newdata.length/3,i=Math.ceil(t),o=[],n=3,s=0,d=1;i>=d;d++){var r=[];for(j=s;j<=newdata.length-1&&j!=n;j++)r.push(newdata[j]);s=3*d,n+=3,o.push({section:r})}console.log("board final data = ",o);var l={};l={gt:e.selectedgtsa,finalData:o},v=b.indexOf(e.selectedgt),idTofocusOn="",v>=0?(idTofocusOn="section--"+v,h[v]=l):(w++,v=w,idTofocusOn="section--"+v,b.push(e.selectedgt),h.push(l)),console.log("board final data in array = ",h),$("#tabs").tabs(),e.sections=o,setTimeout(function(){$(".loader_overlay").hide(),$(".loader_img_overlay").hide(),jQuery(".text_wrap_index").each(function(){"IFRAME"!=$(this).children().first().prop("tagName")}),$(".text_wrap p img").parent().addClass("innerimg-wrap"),m(),e.setName()},10),setTimeout(function(){e.__openDiscussPage()},1e3)}else $(".loader_overlay").hide(),$(".loader_img_overlay").hide(),e.boarddata={}})):e.filterSub())})},1050)},e.changePT2=function(){$(".avatarlist").html(""),$(".avarrow-left").hide(),$(".avatarlist").css("margin-left","0px"),$(".avarrow-right").hide(),l(function(){$("#slideTitleHeader li").each(function(){"hidden"!=$(this).css("visibility")&&(e.selectedgt=$(this).attr("id"),e.selectedgtsa=$(this).find("span").html(),"none"==$("#search_elements").css("display")?($(".loader_overlay").show(),$(".loader_img_overlay").show(),t.post("/boards",{id:d.id}).then(function(a){if(200==a.data.code){e.boarddata=a.data.response,console.log("board data = ",e.boarddata);var t=[];for(r in e.boarddata[0].Medias)e.selectedgt==e.boarddata[0].Medias[r].ThemeID&&t.push(e.boarddata[0].Medias[r]);e.boarddata[0].Medias=[],e.boarddata[0].Medias=t;for(var i=t.length/3,o=Math.ceil(i),n=[],s=3,d=0,r=1;o>=r;r++){var l=[];for(j=d;j<=t.length-1&&j!=s;j++)l.push(t[j]);d=3*r,s+=3,n.push({section:l})}y(n),setTimeout(function(){$(".loader_overlay").hide(),$(".loader_img_overlay").hide(),jQuery(".text_wrap_index").each(function(){"IFRAME"!=$(this).children().first().prop("tagName")}),$(".text_wrap p img").parent().addClass("innerimg-wrap"),m()},10)}else $(".loader_overlay").hide(),$(".loader_img_overlay").hide(),e.boarddata={}})):e.filterSub())})},1050)};var T="",y=function(a){T="";var t="";T+='<div id="section--{{$index}}" data-ng-repeat= "sections in arraySections"><p onClick="prevPageTheme();" data-ng-click="changePT()" href="javascript:void(0)"><a>Load Previous</a></p><div style="min-height:400px;"><div><p>{{sections.gt}}</p></div>',T+='<section class="row-{{$index+1}} fluid-container" data-ng-repeat= "sectiondivider in sections.finalData"><div class="row"><div class="col-sm-6 toflip fixedheight cover_img" id="thumbs" data-ng-repeat="media in sectiondivider.section"><a class="item" onclick="clicked($(this),event)" href="javascript:void(0)"><div class="caption"><img data-ng-src="{{media.PostedBy.ProfilePic}}" style="border-radius:30px;" alt="" height="30" width="30" class="avatar"><h3 style="display:block !important" data-ng-show="boarddata[0].PrivacySetting[0].DisplayNames==RealNames">{{media.PostedBy.Name}}</h3><h3 style="display:block !important" data-ng-show="boarddata[0].PrivacySetting[0].DisplayNames==NickNames">{{media.PostedBy.NickName}}</h3></div><span class="text_wrap_index" data-ng-if=\'media.MediaType=="Link" || media.MediaType=="Notes"\' style="color:#fff"  data-ng-bind-html="media.Content | to_trusted" ></span><img class="media_img" data-ng-if=\'media.ContentType=="application/pdf"\' class=""  data-ng-src="../assets/img/PDF.png" alt="Sample PDF 1" /><video class="media_video" data-ng-if=\'media.ContentType=="video/webm"\' controls ><source src="" dynamic-url dynamic-url-src="../assets/Media/video/{{media.MediaURL}}"></video><img class="media_img" data-ng-if=\'media.ContentType=="application/vnd.openxmlformats-officedocument.wordprocessingml.document" || media.ContentType=="application/msword"\' class=""  data-ng-src="../assets/img/Icon-Document.jpg" alt="Sample Word 1" /><img class="media_img" data-ng-if=\'media.ContentType=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || media.ContentType=="application/vnd.ms-excel" || media.ContentType=="application/vnd.oasis.opendocument.spreadsheet"\' class=""  data-ng-src="../assets/img/excel.png" alt="Sample Excel 1" /><img class="media_img" data-ng-if=\'media.ContentType=="application/vnd.openxmlformats-officedocument.presentationml.presentation" || media.ContentType=="application/vnd.ms-powerpoint"\' class=""  data-ng-src="../assets/img/ppt.png" alt="Sample PPT 1" /><img class="media_img" data-ng-if=\'media.ContentType=="image/png" || media.ContentType=="image/jpeg" || media.ContentType=="image/gif" || media.ContentType==null\' class=""  data-ng-src="../assets/Media/img/{{media.MediaURL}}" alt="Sample Image 1" /> <div class="overlay anim"></div></a><div class="format_file_right cross_format anim" style="top:0;cursor:pointer;" data-ng-show="showsetting" data-ng-click="deleteMedia(media)" title="Delete"></div><div style="margin-bottom:0px;cursor:pointer;" class="format_file tick_format anim" data-ng-click="mark(media)" data-ng-show="showsetting && media.PostedBy._id!=userInfo._id" title="Mark"></div><div style="margin-bottom:0px;cursor:pointer;" class="format_file_mid vote_format anim" data-ng-show="showsetting && media.PostedBy._id!=userInfo._id" data-ng-click="stamp(media)" title="Stamp"></div><div style="margin-bottom:0px;cursor:pointer;" class="format_file_right stamp_format anim" data-ng-show="media.PostedBy._id!=userInfo._id" data-ng-click="vote(media)" title="Vote"></div></div></div></section></div><p onClick="nextPageTheme();" data-ng-click="changePT()" href="javascript:void(0)"><a>Load Next</a></p>',t=angular.element(T),$("#section-cont").html(t),c(t)(e),e.arraySections=a},C=[];r.chkUserLogin(t,o,n).then(function(){e.userInfo=tempData,userdata=e.userInfo,console.log("$scope.userInfo"),console.log(e.userInfo);for(k in userdata.FSGs)C.push(k+"~"+userdata.FSGs[k])}),e.uploadSuccess=function(){$(".upload").each(function(){21==$(this).attr("data-dialog-id")&&$(this).trigger("click")})},e.uploadedMedia123="",e.addTags=function(){e.uploadedMedia._id&&e.media.mmt&&e.media.isPrivate?($("#overlay2").show(),$("#overlayContent2").show(),e.media.gt=e.selectedgt,e.media.gtsa=e.selectedgtsa,e.media.Action="Post",e.media.MediaID=e.uploadedMedia._id,e.media.data={},e.media.board=d.id,e.media.data=e.uploadedMedia,""!=$("#tag-Input-Token").val()&&(e.media.Tags=$("#tag-Input-Token").val()),t.post("/media/addTagsToUploadedMedia",e.media).then(function(a){$(".ui-dialog-titlebar-close").trigger("click"),e.setFlashInstant("Media added successfully!","success"),e.uploadedMedia={},e.changePT(),setTimeout(function(){$("#overlay2").hide(),$("#overlayContent2").hide(),void 0!=a.data.response[0]&&null!=a.data.response[0]&&e.addtoTray_uploadCase(a.data.response[0])},1e3)})):e.uploadedLink._id&&e.link.mmt&&e.link.isPrivate&&($("#overlay2").show(),$("#overlayContent2").show(),console.log(e.uploadedLink),e.link.gt=e.selectedgt,e.link.gtsa=e.selectedgtsa,e.link.Action="Post",""!=$("#tag-Input-Token2").val()&&(e.link.Tags=$("#tag-Input-Token2").val()),e.link.MediaID=e.uploadedLink._id,e.link.data={},e.link.board=d.id,e.link.data=e.uploadedLink,console.log("----input data for addTagsToUploadedMedia = ",e.link),t.post("/media/addTagsToUploadedMedia",e.link).then(function(a){$(".ui-dialog-titlebar-close").trigger("click"),setTimeout(function(){$("#overlay2").hide(),$("#overlayContent2").hide(),"Montage"==e.uploadedLink.ContentType?e.setFlashInstant("Media posted into the Board","success"):(void 0!=a.data.response[0]&&null!=a.data.response[0]&&e.addtoTray_uploadCase(a.data.response[0]),e.setFlashInstant("Media added successfully!","success")),e.close_holder_act(),e.uploadedLink={}},1e3)})),$("#dialog1").css({display:"block"})},e.redirectInSearchGallery=function(){body=$("html, body");var e=$("body"),a=e.data("page-class");body.animate("500"),$(".holder_bulb").html(""),$(".filterMenu-sidebar").show(),e.addClass(a),$(".holder-act").fadeOut(400),$("#discuss_elements").hide(),e.removeClass("act-page"),e.hasClass("home-page")&&e.removeClass("small-fixed-header"),$(".holder-act").hide(),$("#thumbs, #search_elements").show(),$("#filterbar").find("a").show(),e.css({"padding-top":"244px"})},p("searchGalleryCtrl",{$scope:e}),p("actCtrl",{$scope:e}),p("montageCtrl",{$scope:e}),e.fileReaderSupported=null!=window.FileReader,e.uploadRightAway=!1,e.changeAngularVersion=function(){window.location.hash=e.angularVersion,window.location.reload(!0)},e.imagessize=0,e.hasUploader=function(a){return null!=e.upload[a]},e.abort=function(a){e.upload[a].abort(),e.upload[a]=null},e.fileUpload=[],e.disablebtn=!1,e.angularVersion=window.location.hash.length>1?window.location.hash.substring(1):"1.2.0",e.lengthofuploads=0,e.count=0,e.percentUpload=0,e.uploadedMedia={},p("uploadMediaCtrl",{$scope:e}),e.uploadAll=function(){for(e.count=0,i=0;i<e.fileUpload.length;i++)e.start(i)},e.media123={},p("designNsoundCtrl",{$scope:e}),p("boardCtrl",{$scope:e}),p("pageThemesCtrl",{$scope:e}),p("commentCtrl",{$scope:e}),p("memberCtrl",{$scope:e}),p("pageSettingCtrl",{$scope:e}),e.showMore=function(){alert("show more triggered")},$(document).ready(function(){$("#delete_pop").hide()}),e.closeDel=function(){$("#delete_pop").hide()},p("discussCtrl",{$scope:e}),p("recorderCtrl",{$scope:e}),p("dragDropCtrl",{$scope:e})}]);